<!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>DS5220 Final Project</title>
            <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

</style>
            
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item {
    list-style-type: none;
}

.task-list-item-checkbox {
    margin-left: -20px;
    vertical-align: middle;
    pointer-events: none;
}
</style>
<style>
:root {
  --color-note: #0969da;
  --color-tip: #1a7f37;
  --color-warning: #9a6700;
  --color-severe: #bc4c00;
  --color-caution: #d1242f;
  --color-important: #8250df;
}

</style>
<style>
@media (prefers-color-scheme: dark) {
  :root {
    --color-note: #2f81f7;
    --color-tip: #3fb950;
    --color-warning: #d29922;
    --color-severe: #db6d28;
    --color-caution: #f85149;
    --color-important: #a371f7;
  }
}

</style>
<style>
.markdown-alert {
  padding: 0.5rem 1rem;
  margin-bottom: 16px;
  color: inherit;
  border-left: .25em solid #888;
}

.markdown-alert>:first-child {
  margin-top: 0
}

.markdown-alert>:last-child {
  margin-bottom: 0
}

.markdown-alert .markdown-alert-title {
  display: flex;
  font-weight: 500;
  align-items: center;
  line-height: 1
}

.markdown-alert .markdown-alert-title .octicon {
  margin-right: 0.5rem;
  display: inline-block;
  overflow: visible !important;
  vertical-align: text-bottom;
  fill: currentColor;
}

.markdown-alert.markdown-alert-note {
  border-left-color: var(--color-note);
}

.markdown-alert.markdown-alert-note .markdown-alert-title {
  color: var(--color-note);
}

.markdown-alert.markdown-alert-important {
  border-left-color: var(--color-important);
}

.markdown-alert.markdown-alert-important .markdown-alert-title {
  color: var(--color-important);
}

.markdown-alert.markdown-alert-warning {
  border-left-color: var(--color-warning);
}

.markdown-alert.markdown-alert-warning .markdown-alert-title {
  color: var(--color-warning);
}

.markdown-alert.markdown-alert-tip {
  border-left-color: var(--color-tip);
}

.markdown-alert.markdown-alert-tip .markdown-alert-title {
  color: var(--color-tip);
}

.markdown-alert.markdown-alert-caution {
  border-left-color: var(--color-caution);
}

.markdown-alert.markdown-alert-caution .markdown-alert-title {
  color: var(--color-caution);
}

</style>
        
        </head>
        <body class="vscode-body vscode-light">
            <h1 id="ds5220-final-project">DS5220 Final Project</h1>
<div style="text-align: right">DS 5220 Supervised Machine Learning, Spring 2024 </div>
<h2 id="instructions"><strong>Instructions</strong></h2>
<p><em><strong>CIFAR-100</strong></em> is a dataset of 50,000 32x32 color training images and 10,000 test images, labeled over 100 categories.
This project will focus on implementing different classification algorithms on the <em><strong>CIFAR-100</strong></em> dataset.
You could use any programming language (e.g., R, Python, MATLAB) for the project.
Any public packages/resources are allowed.</p>
<p>Here is the list of classes in the CIFAR-100:</p>
<table>
<thead>
<tr>
<th><strong>Superclass</strong></th>
<th><strong>Classes</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>aquatic mammals</strong></td>
<td>beaver, dolphin, otter, seal, whale</td>
</tr>
<tr>
<td><strong>fish</strong></td>
<td>aquarium fish, flatfish, ray, shark, trout</td>
</tr>
<tr>
<td><strong>flowers</strong></td>
<td>orchids, poppies, roses, sunflowers, tulips</td>
</tr>
<tr>
<td><strong>food containers</strong></td>
<td>bottles, bowls, cans, cups, plates</td>
</tr>
<tr>
<td><strong>fruit and vegetables</strong></td>
<td>apples, mushrooms, oranges, pears, sweet peppers</td>
</tr>
<tr>
<td><strong>household electrical devices</strong></td>
<td>clock, computer keyboard, lamp, telephone, television</td>
</tr>
<tr>
<td><strong>household furniture</strong></td>
<td>bed, chair, couch, table, wardrobe</td>
</tr>
<tr>
<td><strong>insects</strong></td>
<td>bee, beetle, butterfly, caterpillar, cockroach</td>
</tr>
<tr>
<td><strong>large carnivores</strong></td>
<td>bear, leopard, lion, tiger, wolf</td>
</tr>
<tr>
<td><strong>large man-made outdoor things</strong></td>
<td>bridge, castle, house, road, skyscraper</td>
</tr>
<tr>
<td><strong>large natural outdoor scenes</strong></td>
<td>cloud, forest, mountain, plain, sea</td>
</tr>
<tr>
<td><strong>large omnivores and herbivores</strong></td>
<td>camel, cattle, chimpanzee, elephant, kangaroo</td>
</tr>
<tr>
<td><strong>medium-sized mammals</strong></td>
<td>fox, porcupine, possum, raccoon, skunk</td>
</tr>
<tr>
<td><strong>non-insect invertebrates</strong></td>
<td>crab, lobster, snail, spider, worm</td>
</tr>
<tr>
<td><strong>people</strong></td>
<td>baby, boy, girl, man, woman</td>
</tr>
<tr>
<td><strong>reptiles</strong></td>
<td>crocodile, dinosaur, lizard, snake, turtle</td>
</tr>
<tr>
<td><strong>small mammals</strong></td>
<td>hamster, mouse, rabbit, shrew, squirrel</td>
</tr>
<tr>
<td><strong>trees</strong></td>
<td>maple, oak, palm, pine, willow</td>
</tr>
<tr>
<td><strong>vehicles 1</strong></td>
<td>bicycle, bus, motorcycle, pickup truck, train</td>
</tr>
<tr>
<td><strong>vehicles 2</strong></td>
<td>lawn-mower, rocket, streetcar, tank, tractor</td>
</tr>
</tbody>
</table>
<h3 id="requirements"><strong>Requirements</strong></h3>
<ol>
<li>In the project, you need to solve the classification problem over the CIFAR-100 dataset with different algorithms and submit a project report.</li>
<li>This project could be completed individually or in a group of two.
<ul>
<li>For group of individual, only two methods are required</li>
<li>For group of two, <strong>four</strong> different methods in total are required</li>
</ul>
</li>
<li>There are several methods that could be good attempts.
<ul>
<li>Logistic Regression</li>
<li>Support Vector Machine (SVM) w/ kernel</li>
<li>SVM w/o kernel</li>
<li>Deep Neural Network (DNN) w/ Convolution Layer (CNN)</li>
<li>DNN w/o CNN</li>
<li>etc.</li>
</ul>
</li>
<li>The report should contain
<ul>
<li>Briefly introduces the methods you use</li>
<li>Analyze the result for each method (graph, accuracy, etc.,)</li>
<li>Compare the difference between each method (in terms of, convergence speed, accuracy...)</li>
<li>The code you used</li>
</ul>
</li>
<li>Submission format:
<ul>
<li>Please submit a project report (*.pdf, *.html) to Canvas</li>
<li>All output and analysis should be included in a single file</li>
</ul>
</li>
</ol>
<h2 id="how-to"><strong>How-to</strong></h2>
<h3 id="download-cifar-100-dataset"><strong>Download CIFAR-100 dataset</strong></h3>
<p>You could download CIFAR-100 dataset from the <a href="https://www.cs.toronto.edu/~kriz/cifar.html">official website</a>,
or you could use the snippet below to download the dataset in terminal.</p>
<pre><code class="language-bash">wget -c https://www.cs.toronto.edu/~kriz/cifar-100-python.tar.gz
tar -vxf cifar-100-python.tar.gz
<span class="hljs-built_in">rm</span> cifar-100-python.tar.gz
</code></pre>
<h3 id="load-cifar-100-dataset-to-python-example"><strong>Load CIFAR-100 dataset to python (example)</strong></h3>
<ul>
<li><a href="#pytorch">PyTorch</a></li>
<li><a href="#kerastensorflow">Keras/TensorFlow</a></li>
<li><a href="#numpy">NumPy</a></li>
</ul>
<h4 id="pytorch"><strong>Pytorch</strong></h4>
<pre><code class="language-python"><span class="hljs-comment"># dependencies</span>
<span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">from</span> torchvision.datasets <span class="hljs-keyword">import</span> CIFAR100
<span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader
<span class="hljs-keyword">import</span> torchvision.transforms <span class="hljs-keyword">as</span> transforms

<span class="hljs-comment">#################### Your Code ####################</span>
ROOT_PATH=<span class="hljs-string">&#x27;./&#x27;</span>  <span class="hljs-comment"># Modify this line with the path to the folder where folder &quot;cifar-10-batches-py&quot; locate</span>
<span class="hljs-comment">###################################################</span>

BATCH_SIZE=<span class="hljs-number">4</span>

transform = transforms.Compose(
    [transforms.ToTensor(),
     transforms.Normalize((<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>), (<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>))])

train_dataset = CIFAR10(root=ROOT_PATH, download=<span class="hljs-literal">True</span>, train=<span class="hljs-literal">True</span>, transform=transform)
eval_dataset = CIFAR10(root=ROOT_PATH, train=<span class="hljs-literal">False</span>, transform=transform)

train_data_loader = DataLoader(dataset=train_dataset, num_workers=<span class="hljs-number">4</span>, batch_size=BATCH_SIZE, shuffle=<span class="hljs-literal">True</span>)
eval_data_loader = DataLoader(dataset=eval_dataset, num_workers=<span class="hljs-number">4</span>, batch_size=BATCH_SIZE, shuffle=<span class="hljs-literal">False</span>)


<span class="hljs-comment">#################### Your Code ####################</span>



<span class="hljs-comment">###################################################</span>
</code></pre>
<h4 id="kerastensorflow"><strong>Keras/TensorFlow</strong></h4>
<pre><code class="language-python"><span class="hljs-comment"># dependencies</span>
<span class="hljs-keyword">import</span> keras
<span class="hljs-keyword">from</span> keras.datasets <span class="hljs-keyword">import</span> cifar100

<span class="hljs-comment"># define num_class</span>
num_classes = <span class="hljs-number">100</span>

<span class="hljs-comment"># load dataset keras will download cifar-100 datset</span>
(x_train, y_train), (x_test, y_test) = cifar100.load_data()  

<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;x_train shape:&#x27;</span>, x_train.shape)
<span class="hljs-built_in">print</span>(x_train.shape[<span class="hljs-number">0</span>], <span class="hljs-string">&#x27;train samples&#x27;</span>)
<span class="hljs-built_in">print</span>(x_test.shape[<span class="hljs-number">0</span>], <span class="hljs-string">&#x27;test samples&#x27;</span>)

<span class="hljs-comment"># (Optional)Convert class vectors to binary class matrices.</span>
y_train = keras.utils.np_utils.to_categorical(y_train, num_classes)
y_test = keras.utils.np_utils.to_categorical(y_test, num_classes)

<span class="hljs-comment">#################### Your Code ####################</span>



<span class="hljs-comment">###################################################</span>
</code></pre>
<h4 id="numpy"><strong>NumPy</strong></h4>
<pre><code class="language-python"><span class="hljs-comment"># dependencies</span>
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-comment">#################### Your Code ####################</span>
ROOT_PATH=<span class="hljs-string">&#x27;./&#x27;</span>  <span class="hljs-comment"># Modify this line with the path to the folder where folder &quot;cifar-100-batches-py&quot; locate</span>
<span class="hljs-comment">###################################################</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">unpickle</span>(<span class="hljs-params">file</span>):
    <span class="hljs-keyword">import</span> pickle
    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> fo:
        <span class="hljs-built_in">dict</span> = pickle.load(fo, encoding=<span class="hljs-string">&#x27;bytes&#x27;</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">dict</span>

meta_data = unpickle(<span class="hljs-string">f&quot;<span class="hljs-subst">{ROOT_PATH}</span>/meta&quot;</span>)
fine_label_names = meta_data[<span class="hljs-string">&quot;fine_label_names&quot;</span>]
coarse_label_names = meta_data[<span class="hljs-string">&quot;coarse_label_names&quot;</span>]
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Fine labels: <span class="hljs-subst">{fine_label_names}</span>&quot;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Coarse labels: <span class="hljs-subst">{coarse_label_names}</span>&quot;</span>)

train_data = unpickle(<span class="hljs-string">f&quot;<span class="hljs-subst">{ROOT_PATH}</span>/train&quot;</span>)
test_data = unpickle(<span class="hljs-string">f&quot;<span class="hljs-subst">{ROOT_PATH}</span>/test&quot;</span>)


train_data = train_data[<span class="hljs-string">b&#x27;data&#x27;</span>]
y_train = train_data[<span class="hljs-string">b&#x27;fine_labels&#x27;</span>]
x_train = <span class="hljs-built_in">list</span>()
<span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> train_data:
    image = np.zeros((<span class="hljs-number">32</span>,<span class="hljs-number">32</span>,<span class="hljs-number">3</span>), dtype=np.uint8)
    image[...,<span class="hljs-number">0</span>] = np.reshape(d[:<span class="hljs-number">1024</span>], (<span class="hljs-number">32</span>,<span class="hljs-number">32</span>)) <span class="hljs-comment"># Red channel</span>
    image[...,<span class="hljs-number">1</span>] = np.reshape(d[<span class="hljs-number">1024</span>:<span class="hljs-number">2048</span>], (<span class="hljs-number">32</span>,<span class="hljs-number">32</span>)) <span class="hljs-comment"># Green channel</span>
    image[...,<span class="hljs-number">2</span>] = np.reshape(d[<span class="hljs-number">2048</span>:], (<span class="hljs-number">32</span>,<span class="hljs-number">32</span>)) <span class="hljs-comment"># Blue channel</span>
    x_train.append(image)

test_data = test_data[<span class="hljs-string">b&#x27;data&#x27;</span>]
y_test = test_data[<span class="hljs-string">b&#x27;fine_labels&#x27;</span>]
x_test = <span class="hljs-built_in">list</span>()
<span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> test_data:
    image = np.zeros((<span class="hljs-number">32</span>,<span class="hljs-number">32</span>,<span class="hljs-number">3</span>), dtype=np.uint8)
    image[...,<span class="hljs-number">0</span>] = np.reshape(d[:<span class="hljs-number">1024</span>], (<span class="hljs-number">32</span>,<span class="hljs-number">32</span>)) <span class="hljs-comment"># Red channel</span>
    image[...,<span class="hljs-number">1</span>] = np.reshape(d[<span class="hljs-number">1024</span>:<span class="hljs-number">2048</span>], (<span class="hljs-number">32</span>,<span class="hljs-number">32</span>)) <span class="hljs-comment"># Green channel</span>
    image[...,<span class="hljs-number">2</span>] = np.reshape(d[<span class="hljs-number">2048</span>:], (<span class="hljs-number">32</span>,<span class="hljs-number">32</span>)) <span class="hljs-comment"># Blue channel</span>
    x_test.append(image)


<span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(x_train), <span class="hljs-string">&#x27;train samples&#x27;</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(x_test), <span class="hljs-string">&#x27;test samples&#x27;</span>)

<span class="hljs-comment">#################### Your Code ####################</span>



<span class="hljs-comment">###################################################</span>
</code></pre>

            
            
        </body>
        </html>
